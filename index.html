<!DOCTYPE html>
<html lang="sk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Na≈°a Svadba - Fotografie</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .upload-area {
            transition: all 0.3s ease;
        }
        .upload-area:hover {
            transform: translateY(-2px);
        }
        .upload-area.dragover {
            background-color: #f0f9ff;
            border-color: #0ea5e9;
        }
        .photo-preview {
            position: relative;
            overflow: hidden;
            border-radius: 8px;
        }
        .photo-preview img {
            transition: transform 0.3s ease;
        }
        .photo-preview:hover img {
            transform: scale(1.05);
        }
        .progress-bar {
            transition: width 0.3s ease;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        .uploading {
            animation: pulse 2s infinite;
        }
    </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-pink-50 via-white to-blue-50">
    <!-- Header -->
    <header class="text-center py-12 px-4">
        <h1 class="text-4xl md:text-6xl font-bold text-gray-800 mb-4">
            üíï Na≈°a Svadba üíï
        </h1>
        <p class="text-lg md:text-xl text-gray-600 max-w-2xl mx-auto">
            Zdieƒæajte s nami svoje najkraj≈°ie spomienky z n√°≈°ho veƒæk√©ho d≈àa!
        </p>
        <div class="mt-6 text-sm text-gray-500">
            <p>üìÖ 15. August 2025 | üìç Bratislava</p>
        </div>
    </header>

    <!-- Main Content -->
    <main class="max-w-4xl mx-auto px-4 pb-12">
        <!-- Upload Section -->
        <div class="bg-white rounded-2xl shadow-xl p-6 md:p-8 mb-8">
            <h2 class="text-2xl md:text-3xl font-bold text-center text-gray-800 mb-6">
                üì∏ Nahrajte svoje fotografie a vide√°
            </h2>
            
            <!-- Upload Area -->
            <div id="uploadArea" class="upload-area border-3 border-dashed border-gray-300 rounded-xl p-8 text-center cursor-pointer hover:shadow-lg">
                <div class="mb-4">
                    <svg class="mx-auto h-16 w-16 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" />
                    </svg>
                </div>
                <h3 class="text-xl font-semibold text-gray-700 mb-2">
                    Kliknite alebo pretiahnite s√∫bory sem
                </h3>
                <p class="text-gray-500 mb-4">
                    Podporovan√© form√°ty: JPG, PNG, MP4, MOV (max 50MB na s√∫bor)
                </p>
                <button class="bg-gradient-to-r from-pink-500 to-purple-600 text-white px-8 py-3 rounded-full font-semibold hover:from-pink-600 hover:to-purple-700 transition-all transform hover:scale-105">
                    Vybra≈• s√∫bory
                </button>
            </div>

            <!-- Hidden File Input -->
            <input type="file" id="fileInput" multiple accept="image/*,video/*" class="hidden">

            <!-- Progress Section -->
            <div id="progressSection" class="mt-6 hidden">
                <div class="bg-gray-100 rounded-lg p-4">
                    <div class="flex items-center justify-between mb-2">
                        <span class="text-sm font-medium text-gray-700">Nahr√°vanie s√∫borov...</span>
                        <span id="progressText" class="text-sm text-gray-500">0%</span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-2">
                        <div id="progressBar" class="progress-bar bg-gradient-to-r from-pink-500 to-purple-600 h-2 rounded-full" style="width: 0%"></div>
                    </div>
                </div>
            </div>

            <!-- Upload Status -->
            <div id="uploadStatus" class="mt-4 hidden">
                <div class="flex items-center justify-center p-4 rounded-lg">
                    <svg class="h-6 w-6 text-green-500 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                    </svg>
                    <span class="text-green-700 font-medium">S√∫bory boli √∫spe≈°ne nahran√©!</span>
                </div>
            </div>
        </div>

        <!-- Preview Section -->
        <div id="previewSection" class="bg-white rounded-2xl shadow-xl p-6 md:p-8 hidden">
            <h3 class="text-xl font-bold text-gray-800 mb-4">üì∑ N√°hƒæad vybran√Ωch s√∫borov</h3>
            <div id="previewGrid" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
                <!-- Preview items will be added here -->
            </div>
        </div>

        <!-- Info Section -->
        <div class="bg-white rounded-2xl shadow-xl p-6 md:p-8 mt-8">
            <h3 class="text-xl font-bold text-gray-800 mb-4">‚ÑπÔ∏è Inform√°cie</h3>
            <div class="grid md:grid-cols-2 gap-6 text-gray-600">
                <div>
                    <h4 class="font-semibold text-gray-800 mb-2">Ako nahra≈• fotografie:</h4>
                    <ul class="space-y-1 text-sm">
                        <li>‚Ä¢ Kliknite na tlaƒçidlo "Vybra≈• s√∫bory"</li>
                        <li>‚Ä¢ Alebo pretiahnite s√∫bory priamo do oblasti</li>
                        <li>‚Ä¢ M√¥≈æete vybra≈• viacero s√∫borov naraz</li>
                        <li>‚Ä¢ Nahr√°vanie prebieha automaticky</li>
                    </ul>
                </div>
                <div>
                    <h4 class="font-semibold text-gray-800 mb-2">Technick√© inform√°cie:</h4>
                    <ul class="space-y-1 text-sm">
                        <li>‚Ä¢ Maxim√°lna veƒækos≈•: 50MB na s√∫bor</li>
                        <li>‚Ä¢ Podporovan√© form√°ty: JPG, PNG, MP4, MOV</li>
                        <li>‚Ä¢ S√∫bory sa ukladaj√∫ bezpeƒçne do cloudu</li>
                        <li>‚Ä¢ Nemus√≠te sa prihlasova≈•</li>
                    </ul>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="text-center py-8 text-gray-500">
        <p class="mb-2">ƒéakujeme, ≈æe zdieƒæate s nami tieto kr√°sne chv√≠le! üíï</p>
        <p class="text-sm">V≈°etky nahran√© s√∫bory s√∫ bezpeƒçne ulo≈æen√© a pr√≠stupn√© len pre mladoman≈æelov.</p>
    </footer>

    <script>
        class WeddingPhotoUploader {
            constructor() {
                this.uploadArea = document.getElementById('uploadArea');
                this.fileInput = document.getElementById('fileInput');
                this.progressSection = document.getElementById('progressSection');
                this.progressBar = document.getElementById('progressBar');
                this.progressText = document.getElementById('progressText');
                this.uploadStatus = document.getElementById('uploadStatus');
                this.previewSection = document.getElementById('previewSection');
                this.previewGrid = document.getElementById('previewGrid');
                
                this.maxFileSize = 50 * 1024 * 1024; // 50MB
                this.allowedTypes = ['image/jpeg', 'image/png', 'image/jpg', 'video/mp4', 'video/mov', 'video/quicktime'];
                
                this.initEventListeners();
            }

            initEventListeners() {
                // Click to upload
                this.uploadArea.addEventListener('click', () => {
                    this.fileInput.click();
                });

                // File input change
                this.fileInput.addEventListener('change', (e) => {
                    this.handleFiles(e.target.files);
                });

                // Drag and drop
                this.uploadArea.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    this.uploadArea.classList.add('dragover');
                });

                this.uploadArea.addEventListener('dragleave', () => {
                    this.uploadArea.classList.remove('dragover');
                });

                this.uploadArea.addEventListener('drop', (e) => {
                    e.preventDefault();
                    this.uploadArea.classList.remove('dragover');
                    this.handleFiles(e.dataTransfer.files);
                });
            }

            handleFiles(files) {
                const validFiles = Array.from(files).filter(file => {
                    if (!this.allowedTypes.includes(file.type)) {
                        alert(`S√∫bor ${file.name} m√° nepodporovan√Ω form√°t.`);
                        return false;
                    }
                    if (file.size > this.maxFileSize) {
                        alert(`S√∫bor ${file.name} je pr√≠li≈° veƒæk√Ω (max 50MB).`);
                        return false;
                    }
                    return true;
                });

                if (validFiles.length > 0) {
                    this.showPreviews(validFiles);
                    this.uploadFiles(validFiles);
                }
            }

            showPreviews(files) {
                this.previewGrid.innerHTML = '';
                this.previewSection.classList.remove('hidden');

                files.forEach((file, index) => {
                    const previewItem = document.createElement('div');
                    previewItem.className = 'photo-preview bg-gray-100 aspect-square flex items-center justify-center';
                    
                    if (file.type.startsWith('image/')) {
                        const img = document.createElement('img');
                        img.className = 'w-full h-full object-cover';
                        img.src = URL.createObjectURL(file);
                        previewItem.appendChild(img);
                    } else {
                        const videoIcon = document.createElement('div');
                        videoIcon.className = 'text-center';
                        videoIcon.innerHTML = `
                            <svg class="mx-auto h-12 w-12 text-gray-400 mb-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z" />
                            </svg>
                            <p class="text-xs text-gray-500">${file.name}</p>
                        `;
                        previewItem.appendChild(videoIcon);
                    }

                    this.previewGrid.appendChild(previewItem);
                });
            }

            async uploadFiles(files) {
                this.progressSection.classList.remove('hidden');
                this.uploadStatus.classList.add('hidden');
                this.uploadArea.classList.add('uploading');

                let totalProgress = 0;
                const progressStep = 100 / files.length;

                for (let i = 0; i < files.length; i++) {
                    const file = files[i];
                    
                    try {
                        // Upload file to backend
                        await this.uploadFile(file, (progress) => {
                            const fileProgress = (i * progressStep) + (progress * progressStep / 100);
                            this.updateProgress(fileProgress);
                        });

                        totalProgress += progressStep;
                    } catch (error) {
                        console.error(`Failed to upload ${file.name}:`, error);
                        // Continue with other files even if one fails
                        totalProgress += progressStep;
                    }
                }

                // Complete upload
                this.updateProgress(100);
                setTimeout(() => {
                    this.progressSection.classList.add('hidden');
                    this.uploadStatus.classList.remove('hidden');
                    this.uploadArea.classList.remove('uploading');
                    
                    // Show success message
                    const statusDiv = this.uploadStatus.querySelector('div');
                    statusDiv.className = 'flex items-center justify-center p-4 rounded-lg bg-green-50 border border-green-200';
                }, 1000);
            }

            async uploadFile(file, onProgress) {
                return new Promise((resolve, reject) => {
                    const formData = new FormData();
                    formData.append('file', file);

                    const xhr = new XMLHttpRequest();

                    // Progress tracking
                    xhr.upload.addEventListener('progress', (e) => {
                        if (e.lengthComputable) {
                            const progress = (e.loaded / e.total) * 100;
                            onProgress(progress);
                        }
                    });

                    xhr.addEventListener('load', () => {
                        if (xhr.status === 200) {
                            try {
                                const response = JSON.parse(xhr.responseText);
                                resolve(response);
                            } catch (e) {
                                reject(new Error('Invalid response format'));
                            }
                        } else {
                            reject(new Error(`Upload failed: ${xhr.status}`));
                        }
                    });

                    xhr.addEventListener('error', () => {
                        reject(new Error('Network error during upload'));
                    });

                    xhr.open('POST', '/api/upload');
                    xhr.send(formData);
                });
            }

            updateProgress(progress) {
                this.progressBar.style.width = `${progress}%`;
                this.progressText.textContent = `${Math.round(progress)}%`;
            }
        }

        // Initialize the uploader when DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            new WeddingPhotoUploader();
        });
    </script>
</body>
</html>
